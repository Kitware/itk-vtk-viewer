"use strict";const path=require("path"),fs=require("graceful-fs"),pathExists=require("../path-exists").pathExists;function symlinkPaths(t,s,e){if(path.isAbsolute(t))return fs.lstat(t,(s=>s?(s.message=s.message.replace("lstat","ensureSymlink"),e(s)):e(null,{toCwd:t,toDst:t})));{const a=path.dirname(s),n=path.join(a,t);return pathExists(n,((s,r)=>s?e(s):r?e(null,{toCwd:n,toDst:t}):fs.lstat(t,(s=>s?(s.message=s.message.replace("lstat","ensureSymlink"),e(s)):e(null,{toCwd:t,toDst:path.relative(a,t)})))))}}function symlinkPathsSync(t,s){let e;if(path.isAbsolute(t)){if(e=fs.existsSync(t),!e)throw new Error("absolute srcpath does not exist");return{toCwd:t,toDst:t}}{const a=path.dirname(s),n=path.join(a,t);if(e=fs.existsSync(n),e)return{toCwd:n,toDst:t};if(e=fs.existsSync(t),!e)throw new Error("relative srcpath does not exist");return{toCwd:t,toDst:path.relative(a,t)}}}module.exports={symlinkPaths,symlinkPathsSync};