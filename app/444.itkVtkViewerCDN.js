!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("itkVtkViewer",[],r):"object"==typeof exports?exports.itkVtkViewer=r():e.itkVtkViewer=r()}(self,(()=>(()=>{var e,r,n={9857:(e,r,n)=>{"use strict";var t=n(8270),a=n(4390),o=n(3486),i=n(4641),u=n(4264),c=n.n(u),s=n(6579),p=n.n(s),f=n(7800),m=n(4630),l=n(16),g=n(474),d=n.n(g);function b(){var e=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return{add:function(n){e>n&&(e=n),r<n&&(r=n)},getRange:function(){return{min:e,max:r}}}}var v="function"==typeof globalThis.SharedArrayBuffer,y=navigator.hardwareConcurrency?Math.min(navigator.hardwareConcurrency,8):4,h=function(e,r,n){var t=function(e){var n=null!=e?e:r();return{webWorkerPromise:new(d())(n),worker:n}},o=function(){var e=(0,a.Z)(c().mark((function e(r){var a,o,i,u,s,p,f,m=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=t(r),o=a.webWorkerPromise,i=a.worker,u=m.length,s=new Array(u>1?u-1:0),p=1;p<u;p++)s[p-1]=m[p];return e.next=4,o.exec.apply(o,[n].concat(s));case 4:return f=e.sent,e.abrupt("return",{result:f,webWorker:i});case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return new l.Z(e,o)}(y,(function(){return new Worker(new URL(n.p+n.u(764),n.b),{type:void 0})}),"computeRanges");function w(e){return k.apply(this,arguments)}function k(){return k=(0,a.Z)(c().mark((function e(r){var n,t,a,i,u,s,p,f,m,l,g,d,w=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=w.length>1&&void 0!==w[1]?w[1]:1,t=y,a=new Array(t),v&&r.buffer instanceof SharedArrayBuffer)for(i=0;i<t;i++)a[i]=[{split:i,numberOfSplits:t,values:r,numberOfComponents:n}];else for(u=Math.floor(r.length/t)||1,u+=u%n,s=0,p=0;p<t;p++)f=s,m=Math.min(s+u,r.length-1),l=r.slice(f,m+1),a[p]=[{split:0,numberOfSplits:1,values:l,numberOfComponents:n},[l.buffer]],s+=u;return e.next=6,h.runTasks(a).promise;case 6:return g=e.sent,d=(0,o.Z)(Array(n)).map(b),g.forEach((function(e){e.result.forEach((function(e,r){var n=e.min,t=e.max;d[r].add(n),d[r].add(t)}))})),e.abrupt("return",d.map((function(e){return e.getRange()})));case 10:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}var x=n(8155),O=n(6344),j=n(2182),Z=n(8677),I=n(6275);function P(e){return E.apply(this,arguments)}function E(){return E=(0,a.Z)(c().mark((function e(r){var n,t,a,i,u,s,p,f,m,g,d,b,v,y,h,w,k,P,E;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.pipeline,t=r.args,a=r.images,i=r.outputs,u=void 0===i?[{type:x.Z.Image}]:i,s=r.maxSplits,p=void 0===s?4:s,f=I.Z.pipelinesUrl,m=I.Z.pipelineWorkerUrl,g=f.startsWith("blob:")?f.substring(5):f,I.Z.pipelinesUrl=new URL(g,self.location.origin).href,d=m.startsWith("blob:")?m.substring(5):m,I.Z.pipelineWorkerUrl=new URL(d,self.location.origin).href,b=navigator.hardwareConcurrency||6,v=a[0],y=Math.min(parseInt(b/2),Math.max(v.size[v.size.length-1],1),p),h=(0,o.Z)(Array(y).keys()).map((function(e){var r=[].concat((0,o.Z)((0,o.Z)(Array(a.length).keys()).map((function(e){return e.toString()}))),["0"],(0,o.Z)(t.map((function(e){return e.toString()}))),["--max-total-splits",""+y,"--split",""+e,"--number-of-splits",""+y,"--memory-io"]),i=a.map((function(e){return{type:x.Z.Image,data:(0,O.Z)(e)}}));return[n,r,u,i]})),w=new l.Z(b,j.Z),e.next=13,w.runTasks(h).promise;case 13:return k=e.sent,w.terminateWorkers(),P=k.filter((function(e){return 0===e.returnValue})),E=P.map((function(e){return e.outputs[0].data})),e.abrupt("return",(0,Z.Z)(E));case 18:case"end":return e.stop()}}),e)}))),E.apply(this,arguments)}async function T(e,r,{minMax:n,checkerboard:t,pattern:a}){const o=a?r.size.map(((e,r)=>Math.min(e,a[r]))):[],i=["--checkerboard",t.toString(),"--range",n.join(","),"--pattern",o.join(",")],u=await P({pipeline:"Compare",args:i,images:[e,r],maxSplits:1});return u.ranges=[n,n],u}async function C(e,r){const{size:n,spacing:t,origin:a,direction:o}=e;return P({pipeline:"ResampleLabelImage",args:["--size",n.join(","),"--spacing",t.join(","),"--origin",a.join(","),"--direction",o.join(",")],images:[r]})}function A(e,r){return["size","direction","origin","spacing"].map((n=>function(e,r){if(e===r)return!0;if(null==e||null==r)return!1;if(e.length!==r.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==r[n])return!1;return!0}(e[n],r[n]))).every((e=>e))}function S(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function V(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?S(Object(n),!0).forEach((function(r){(0,t.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var M=function(e,r){return e+r},N=function(e){for(var r=e.componentInfo,n=e.arrayToFill,t=function(e){return e.map((function(e){var r=e.data,n=e.srcComponentCount;return r.length/n})).reduce(M)}(r),a=null!=n?n:new(function(e){return e.map((function(e){return e.data})).reduce((function(e,r){return e.BYTES_PER_ELEMENT>=r.BYTES_PER_ELEMENT?e:r}))}(r).constructor)(t),o=r.length,i=t/o,u=0;u<o;u++)for(var c=r[u],s=c.data,p=c.srcComponentCount,f=c.fromComponent,m=0;m<i;m++)a[m*o+u]=s[m*p+f];return a},R=function(e){return e?(Array.isArray(e)?e:[e]).flatMap((function(e){var r=e.imageType.components;return(0,o.Z)(Array(r).keys()).map((function(n){return{fromComponent:n,srcComponentCount:r,image:e,data:e.data}}))})):[]},U=function(){var e=(0,a.Z)(c().mark((function e(r){var n,t,a,o,u,s,p,f,m,l,g,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.image,t=r.labelImage,a=r.components,Array.isArray(n)||t||n.imageType.components!==a.length){e.next=3;break}return e.abrupt("return",n);case 3:return o=[n,t].map((function(e){return R(e)})),u=(0,i.Z)(o,2),s=u[0],p=u[1],(f=a.map((function(e){return e>=0?s[e]:p[-1*e-1]}))).forEach((function(e,r){if(!e)throw new Error("pickAndFuseComponents: Missing component for requested component: "+r)})),m=N({componentInfo:f}),l=f.map((function(e){var r=e.image.ranges,n=e.fromComponent;return r&&r[n]})),g=Array.isArray(n)?n[0]:n,d=V(V({},g),{},{data:m,imageType:V(V({},g.imageType),{},{components:a.length}),ranges:l}),e.abrupt("return",d);case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();function D(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function W(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?D(Object(n),!0).forEach((function(r){(0,t.Z)(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var _=function(){var e=(0,a.Z)(c().mark((function e(r){var n,t,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=R(r),null===(u=void 0,n=null===(u=t.map((function(e){var r=e.image.ranges,n=e.fromComponent;return null==r?void 0:r[n]})).reduce((function(e,r){if(e&&r)return[].concat((0,o.Z)(e),[r])}),[]))||void 0===u?void 0:u.map((function(e){var r=(0,i.Z)(e,2);return{min:r[0],max:r[1]}})))||void 0===n){e.next=5;break}e.t0=n,e.next=8;break;case 5:return e.next=7,w(r.data,t.length);case 7:e.t0=e.sent;case 8:return a=e.t0,r.ranges=a.map((function(e){return[e.min,e.max]})),e.abrupt("return",r);case 11:case"end":return e.stop()}var u}),e)})));return function(r){return e.apply(this,arguments)}}(),z=function(){var e=(0,a.Z)(c().mark((function e(r){var n,t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.targetImage,(t=r.resampleImage)&&n){e.next=3;break}return e.abrupt("return",t);case 3:if(!A(n,t)){e.next=5;break}return e.abrupt("return",t);case 5:return e.abrupt("return",C(n,t));case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),B=function(e,r){var n=r.filter((function(e){return e>=0}));return U({image:e,components:n})},L=function(e){return Array.isArray(e)?(n=(r=e).map((function(e){return e.imageType.components})).reduce(M),t=(0,o.Z)(Array(n).keys()),U({image:r,components:t})):e;var r,n,t},F=function(){var e=(0,a.Z)(c().mark((function e(r){var n,t,a,o,u,s,p,l,g,d,v;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.image,t=r.fixedImage,(a=r.options).method&&"disabled"!==a.method){e.next=3;break}return e.abrupt("return",n);case 3:if(t){e.next=6;break}return console.error("No fixed image"),e.abrupt("return");case 6:return e.next=8,L(n);case 8:return o=e.sent,e.next=11,L(t);case 11:return u=e.sent,void 0,void 0,h=void 0,w=void 0,c=[o,u].map(f.Z.convertItkToVtkImage),h=(y=(0,i.Z)(c,2))[0],w=y[1],m.ZP.intersects(h.getBounds(),w.getBounds())||console.warn("Trying to compare images but bounds do not intersect. Moving image will be empty."),e.next=15,_(u);case 15:return s=e.sent,p=s.ranges,l=b(),p.flat().forEach((function(e){return l.add(e)})),g=l.getRange(),d=g.min,v=g.max,e.abrupt("return",T(o,u,W({minMax:[d,v]},a)));case 21:case"end":return e.stop()}var c,y,h,w}),e)})));return function(r){return e.apply(this,arguments)}}(),Y=function(){var e=(0,a.Z)(c().mark((function e(r,n){var t,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat((0,o.Z)(Array(r.imageType.components).keys()),[-1]),e.next=3,U({image:r,labelImage:n,components:t});case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}();p()(function(){var e=(0,a.Z)(c().mark((function e(r){var n,t,a,o,i,u,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.image,t=r.labelImage,a=r.visualizedComponents,o=r.fixedImage,i=r.compare,e.next=3,F({image:n,fixedImage:o,options:i});case 3:return u=e.sent,e.next=6,B(u,a);case 6:return u=e.sent,e.next=9,z({targetImage:u,resampleImage:t});case 9:if(!(s=e.sent)){e.next=16;break}return e.next=13,Y(u,s);case 13:e.t0=e.sent,e.next=17;break;case 16:e.t0=u;case 17:return u=e.t0,e.next=20,_(u);case 20:return u=e.sent,e.abrupt("return",new(p().TransferableResponse)({image:u},[u.data.buffer]));case 22:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}())},6275:(e,r,n)=>{"use strict";n.d(r,{Z:()=>t});const t={pipelineWorkerUrl:n.p+"itk-wasm@^1.0.0-b.83/dist/web-workers/min-bundles/pipeline.worker.js",imageIOUrl:n.p+"itk-image-io@^1.0.0-b.83",meshIOUrl:n.p+"itk-mesh-io@^1.0.0-b.83",pipelinesUrl:n.p+"itk-vtk-viewer@14.40.2/dist/itk/pipeline"}},5042:()=>{}},t={};function a(e){var r=t[e];if(void 0!==r)return r.exports;var o=t[e]={id:e,loaded:!1,exports:{}};return n[e].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}return a.m=n,a.x=()=>{var e=a.O(void 0,[880,159,774],(()=>a(9857)));return a.O(e)},a.amdD=function(){throw new Error("define cannot be used indirect")},a.amdO={},e=[],a.O=(r,n,t,o)=>{if(!n){var i=1/0;for(p=0;p<e.length;p++){for(var[n,t,o]=e[p],u=!0,c=0;c<n.length;c++)(!1&o||i>=o)&&Object.keys(a.O).every((e=>a.O[e](n[c])))?n.splice(c--,1):(u=!1,o<i&&(i=o));if(u){e.splice(p--,1);var s=t();void 0!==s&&(r=s)}}return r}o=o||0;for(var p=e.length;p>0&&e[p-1][2]>o;p--)e[p]=e[p-1];e[p]=[n,t,o]},a.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return a.d(r,{a:r}),r},a.d=(e,r)=>{for(var n in r)a.o(r,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},a.f={},a.e=e=>Promise.all(Object.keys(a.f).reduce(((r,n)=>(a.f[n](e,r),r)),[])),a.u=e=>e+".itkVtkViewerCDN.js",a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),a.p="https://cdn.jsdelivr.net/npm/",(()=>{a.b=self.location+"";var e={444:1};a.f.i=(r,n)=>{e[r]||importScripts(a.p+a.u(r))};var r=self.webpackChunkitkVtkViewer=self.webpackChunkitkVtkViewer||[],n=r.push.bind(r);r.push=r=>{var[t,o,i]=r;for(var u in o)a.o(o,u)&&(a.m[u]=o[u]);for(i&&i(a);t.length;)e[t.pop()]=1;n(r)}})(),r=a.x,a.x=()=>Promise.all([880,159,774].map(a.e,a)).then(r),a.x()})()));